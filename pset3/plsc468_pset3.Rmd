---
title: "PLSC 468 Pset 3"
author: "Kelly Farley, Numi Katz, and Chelsea Wang"
date: "4/8/2022"
output:
  html_document:
    toc: yes
    toc_float: yes
    theme: united
  pdf_document:
    toc: yes
---

```{r setup, include=FALSE}
rm(list = ls()) # clear global environ

knitr::opts_chunk$set(echo = TRUE, cache = TRUE, warning = FALSE, message = FALSE)

# set working directory (change for each user)
wd <- "/Users/kellyfarley/Desktop/machine_learning/plsc468_psets"
#wd <- "/Users/numikatz/Documents/Senior_Year/Spring_22/PLSC_468/PLSC_468/plsc468_psets"
knitr::opts_knit$set(root.dir = wd)

# load libraries
library(tidyverse)
library(lda)
library(stm)
```

Goal: to estimate a series of unsupervised topic models using 3255 ads aired in 2008

# Part 1

**Goal: Choose an appropriate value to set for the number of topics *K* that will be estimated for each model**

*Our choice of K:*

*Description of method:*

*Defense of method:*

*Preprocessing of ad strings into correct format for lda() and stm():*

# Part 2

**Goal: Setting k = K, estimate the following topic models. For each model, produce a list of the top 10 most frequent works across each of the k topics**

## 2a: Unsupervised LDA model using lda::lda.collapsed.gibs.sampler(.., k) (Numi)

## 2b: Supervised LDA model to predict *party* using lda::slda.em(..., party, k) (Numi)

## 2c: Supervised LDA model to predict *tone* using lda::slda.em(..., tone, k) (Numi)

## 2d: Structural topic model using stm::stm(..., prevalence = ~ party + tone, k) (Kelly)

Good reference: https://sicss.io/2019/materials/day3-text-analysis/topic-modeling/rmarkdown/Topic_Modeling.html

We use the function textProcessor() to build our corpus. This function converts text to lowercase, removes punctuation, stopwords, and numbers, and stems words.

```{r}
load("pset3/adData.Rdata") # laod data

processed <- textProcessor(ads$texts, metadata = ads) # clean data

# stm pacakge requires storing docs, meta data, and vocab
out <- prepDocuments(processed$documents, processed$vocab, processed$meta) # eliminates very common and very rare terms
docs <- out$documents
vocab <- out$vocab
meta <-out$meta
```

## 2e: Structural topic model using stm::stm(..., prevalence = ~ party + tone + office + policy + as.factor(state), k) (Kelly)

## Reflection

**Are these roughly the same topics, or are there major differences in the topics being estimated?**